{% extends "base.html" %}
{% block content %}
<h3>Barang Masuk</h3>

<form method="post" action="{{ url_for('admin_stock_in_add') }}" class="row gx-2 gy-2 align-items-center mb-3">
  <div class="col-md-4 col-sm-6">
    <input name="nama_barang" class="form-control" placeholder="Nama Barang" required>
  </div>
  <div class="col-md-2 col-sm-3">
    <input name="qty" type="number" class="form-control" placeholder="Qty" required>
  </div>
  <div class="col-md-2 col-sm-3">
    <input name="harga" type="number" class="form-control" placeholder="Harga" step="0.01" required>
  </div>
  <div class="col-md-3 col-sm-4">
    <input name="tgl_pembelian" type="date" class="form-control" required>
  </div>
  <div class="col-md-1 col-sm-12 d-grid">
    <button type="submit" class="btn btn-success w-100">Tambah</button>
  </div>
</form>


<table class="table table-bordered table-hover align-middle">
  <thead class="table-success text-center">
    <tr>
	  <th>No</th> <!-- ✅ kolom nomor -->
      <th>Barang</th>
      <th>Qty</th>
      <th>Harga</th>
      <th>Tanggal Pembelian</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody>
    {% for i in items %}
    <tr>
	  <td class="text-center">{{ loop.index + ((page - 1) * per_page) }}</td> <!-- ✅ nomor otomatis -->
      <td>{{ i['nama_barang'] }}</td>
      <td>{{ i['qty'] }}</td>
      <td>{{ "{:,.0f}".format(i['harga']) }}</td>
      <td>{{ i['tgl_pembelian'] }}</td>
      <td class="text-center">
        <form action="{{ url_for('admin_stock_in_delete', item_id=i['id']) }}" method="post" class="d-inline">
          <button type="submit" class="btn btn-sm btn-danger"
            onclick="return confirm('Yakin ingin menghapus data ini?')">Hapus</button>
        </form>
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="5" class="text-center text-muted">Belum ada data.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<!-- Pagination -->
<nav aria-label="Page navigation" class="mt-3">
  <ul class="pagination justify-content-center">
    {% if page > 1 %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page - 1 }}">« Prev</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">« Prev</span></li>
    {% endif %}

    {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a class="page-link" href="?page={{ p }}">{{ p }}</a>
      </li>
    {% endfor %}

    {% if page < total_pages %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page + 1 }}">Next »</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next »</span></li>
    {% endif %}
  </ul>
</nav>

{% endblock %}
